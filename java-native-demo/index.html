<!DOCTYPE html><html lang="null"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="中南大学|清华大学软件学院唐磊的博客,主攻软件工程,数据挖掘,这里记录了我的学习，生活和工作"><title>java native例子 | tanglei's blog|唐磊的个人博客</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/pure-min.css"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">java native例子</h1><a id="logo" href="/.">tanglei's blog|唐磊的个人博客</a><p class="description">记录我的学习、生活、工作。</p></div><div id="nav-menu"><a href="/." class="current"><i class="icon-home"> 首页</i></a><a href="/archives/"><i class="icon-archive"> 归档</i></a><a href="/about/"><i class="icon-about"> 关于</i></a><a href="/atom.xml"><i class="icon-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">java native例子</h1><div class="post-meta">2010-12-21 | <span class="categories">分类于<a href="/categories/JAVA/"> JAVA</a></span></div><div class="post-content"><p>研究了下java native方法的例子。网上看了下资料。</p>
<p>首先看下什么是Native method，参考了下<a href="http://www.80&#215;86.cn/article.asp?id=1448上的文章" target="_blank" rel="external">http://www.80&#215;86.cn/article.asp?id=1448上的文章</a></p>
<p>Simply put, a native method is the Java interface to non-Java code. It is Java&#8217;s link to the &#8220;outside world.&#8221; More specifically, a native method is a Java method whose implementation is provided by non-Java code, most likely C。大概意思就是说native方法是通过java调用其他非java的代码。</p>
<p>in your Java class, you mark the methods you wish to implement outside of Java with the native method modifier-much like you would use the public or static modifiers. Then, rather than supplying the method&#8217;s body, you simply place a semicolon in its place.The only thing special about this declaration is that the keyword native is used as a modifier. Every other Java method modifier can be used along with native, except abstract.说的是native关键字跟其他什么public static修饰符一样也可以用来修饰方法。但除了abstract。This is logical, because the native modifier implies that an implementation exists, and the abstract modifier insists that there is no implementation. Your native methods can be static methods, thus not requiring the creation of an object (or instance of a class).这是合理的，因为native暗示这些方法是有实现体的，只不过这些实现体是非java的，但是abstract却显然的指明这些方法无实现体。呵呵。我就不翻译原文了。有兴趣的看看原文去吧。</p>
<p>再查了些资料，就写了如下的代码。这个代码又是helloworld。唉，继续helloworld吧。用java去调用一个用C实现的方法。</p>
<pre>&lt;cc class="java" lines="-1">
/**
* project_name：nativeTest
*  Description:
*  Copyright: Copyright (c) 2010 by tl3shi.
**/
package com.i3zhai.www;
/**
*  Title: NativeHelloWorld.java
*  Description:测试java关键字中native的方法
* @author ： <a href="mailto:tanglei3shi@163.com" target="_blank" rel="external">tl3shi</a>
* @date：2010-12-21 下午10:23:24
* @version 1.0
*/
public class NativeHelloWorld
{
/**
* tl3shi
* 下午10:27:23
* Discription: 构造方法，加载dll文件
* 或者用static 引入dll文件也可以，总之就是要在
* 程序用到的时候之前把dll加载进来
*/
public NativeHelloWorld()
{
System.loadLibrary("hello");
}

/**
* tl3shi
* 下午10:28:24
* Discription:声明一个native的方法
* 因为是native的 只是声明，实现由另外的诸如C语言去实现
*/
public native void nativeHello();
/**
* tl3shi
* 下午10:28:59
* Discription:在此类中去调用C语言中实现的方法
*/
public void sayHello()
{
nativeHello();//调用方法
}
}
&lt;/cc></pre>

<p>上面已经写好了注释了。刚开始的时候，我直接用了eclipse，但发现后来dll文件容易找不到(eclipse估计估计还得哪里配置下吧)。于是就改为控制台下。</p>
<p>首先用javac命令 编译出class文件。没有编译错误就会产生class文件。</p>
<p>然后执行javah命令。看javah 的用法。直接控制台下就能看到</p>
<p>R:\native&gt;javah</p>
<p>用法：javah [选项] &lt;类&gt;</p>
<p>其中 [选项] 包括：</p>
<p>-help 输出此帮助消息并退出</p>
<p>-classpath &lt;路径&gt; 用于装入类的路径</p>
<p>-bootclasspath &lt;路径&gt; 用于装入引导类的路径</p>
<p>-d &lt;目录&gt; 输出目录</p>
<p>-o &lt;文件&gt; 输出文件（只能使用 -d 或 -o 中的一个）</p>
<p>-jni 生成 JNI样式的头文件（默认）</p>
<p>-version 输出版本信息</p>
<p>-verbose 启用详细输出</p>
<p>-force 始终写入输出文件</p>
<p>使用全限定名称指定 &lt;类&gt;（例</p>
<p>如，java.lang.Object）。</p>
<p>直接用javah NativeHelloWorld 就会生成一个.h的文件。如下所示：</p>
<pre>&lt;cc class="C">
/* DO NOT EDIT THIS FILE - it is machine generated */
#include
/* Header for class NativeHelloWorld */

#ifndef _Included_NativeHelloWorld
#define _Included_NativeHelloWorld
#ifdef __cplusplus
extern "C" {
#endif
/*
* Class:     NativeHelloWorld
* Method:    nativeHello
* Signature: ()V
*/
JNIEXPORT void JNICALL Java_NativeHelloWorld_nativeHello
(JNIEnv * xx, jobject xxx);

#ifdef __cplusplus
}
#endif
#endif
&lt;/cc></pre>

<p style="text-align: center;"><br>  然后在写hello。c文件如下所示：<br></p>

<pre>&lt;cc class="C">
#include "NativeHelloWorld.h"
JNIEXPORT void JNICALL Java_NativeHelloWorld_nativeHello
(JNIEnv * xx, jobject xxx)
{
printf("helloWorld,I am printing in the C ");
}
&lt;/cc></pre>

<p>JNIEXPORT void JNICALL Java_NativeHelloWorld_nativeHello直接copy头文件里面的就是了，</p>
<p>接下来要做的就是要生成dll文件。这个dll文件就是在类NativeHelloWorld中要load的参数名字。生成dll文件可以用VC6.0之类的工具。期间在build的时候可能会遇到问题。就是上面的方法签名的地方需要加上参数。如上面的XX,xxx。这个是后来加上去的，不是javah之后就有的.</p>
<p>在build的时候，跟着错误信息就知道了，还会用到其他的dll文件。这个文件到jdk安装目录下search下就OK了。有jni.h,其中jni.h又会用到jni_md.h。直接copy过来到VC的工作路径下。然后就能在debug目录里面找到dll文件了。</p>
<p>此时，已经差不多了。再写个Test就OK了。</p>
<pre>&lt;cc class="java">
/**
* Title: NativeHelloWorld.java
* Description:测试java关键字中native的方法
* @author ： <a href="mailto:tanglei3shi@163.com" target="_blank" rel="external">tl3shi</a>
* @date：2010-12-21 下午10:23:24
* @version 1.0
*/
public class Test
{
/**
* tl3shi
* 下午10:23:24
* Discription:
*@param args
*/
public static void main(String[] args)
{
NativeHelloWorld nat = new NativeHelloWorld();
nat.sayHello();
}
}
&lt;/cc></pre>

<p>再在控制台下执行javac Test.java java Test就能看到结果了。</p>
<p><a href="http://www.tanglei.name/wp-content/uploads/2010/12/native1.png"><img class="size-full wp-image-125 aligncenter" title="native" src="http://www.tanglei.name/wp-content/uploads/2010/12/native1.png" alt="" width="339" height="163"></a></p>
<p><a href="http://www.tanglei.name/wp-content/uploads/2010/12/native.zip"></a></p>
<p><a href="http://www.tanglei.name/wp-content/uploads/2010/12/native.zip">文章例子中的源代码SRC下载</a></p>
</div><div class="tags"><a href="/tags/java/">java</a><a href="/tags/java基础/">java基础</a><a href="/tags/native/">native</a></div><div class="post-nav"><a href="/happy-12-22//" class="pre"><i class="icon-previous">Happy!</i></a><a href="/exam_j2ee//" class="next">J2EE考试有感<i class="icon-next"></i></a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search" class="search-form-input"/><input type="hidden" name="sitesearch" value="http://www.tanglei.name"/></form></div><div class="widget"><div class="widget-title">分类</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux-amp-Ubuntu/">Linux&amp;Ubuntu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MyLife/">MyLife</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SoftwareEngineering/">SoftwareEngineering</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/c/">c++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/coding小工具/">coding小工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/wordpress/">wordpress</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/业界动态/">业界动态</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/名人名事/">名人名事</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/实习那些事儿/">实习那些事儿</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作那些事儿/">工作那些事儿</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/开开眼界/">开开眼界</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/我不会算法/">我不会算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/我做站长/">我做站长</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库应用/">数据库应用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据挖掘/">数据挖掘</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/敲敲代码/">敲敲代码</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/清华大学/">清华大学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/玩玩手机/">玩玩手机</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/移动领域/">移动领域</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/经验技巧/">经验技巧</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络文摘/">网络文摘</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机图形学/">计算机图形学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计模式/">设计模式</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/贵州支教行/">贵州支教行</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件0804/">软件0804</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件体系结构/">软件体系结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件学院/">软件学院</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件度量及其应用/">软件度量及其应用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件配置管理/">软件配置管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件项目管理/">软件项目管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/软考/">软考</a></li></ul></div><div class="widget"><div class="widget-title">标签</div><div class="tagcloud"><a href="/tags/青春岁月/" style="font-size: 15px;">青春岁月</a> <a href="/tags/latex/" style="font-size: 15px;">latex</a> <a href="/tags/latex-suite/" style="font-size: 15px;">latex-suite</a> <a href="/tags/mac-osx/" style="font-size: 15px;">mac osx</a> <a href="/tags/vim/" style="font-size: 15px;">vim</a> <a href="/tags/插件/" style="font-size: 15px;">插件</a> <a href="/tags/旅游/" style="font-size: 15px;">旅游</a> <a href="/tags/玩遍世界/" style="font-size: 15px;">玩遍世界</a> <a href="/tags/越南旅游/" style="font-size: 15px;">越南旅游</a> <a href="/tags/回忆录/" style="font-size: 15px;">回忆录</a> <a href="/tags/年终总结/" style="font-size: 15px;">年终总结</a> <a href="/tags/总结/" style="font-size: 15px;">总结</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/自动/" style="font-size: 15px;">自动</a> <a href="/tags/飞行模式/" style="font-size: 15px;">飞行模式</a> <a href="/tags/leetcode/" style="font-size: 15px;">leetcode</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/面试/" style="font-size: 15px;">面试</a> <a href="/tags/面试题/" style="font-size: 15px;">面试题</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/作弊/" style="font-size: 15px;">作弊</a> <a href="/tags/神经猫/" style="font-size: 15px;">神经猫</a> <a href="/tags/debug/" style="font-size: 15px;">debug</a> <a href="/tags/mac/" style="font-size: 15px;">mac</a> <a href="/tags/xcode/" style="font-size: 15px;">xcode</a> <a href="/tags/微软秋令营/" style="font-size: 15px;">微软秋令营</a> <a href="/tags/换行符/" style="font-size: 15px;">换行符</a> <a href="/tags/缓冲区/" style="font-size: 15px;">缓冲区</a> <a href="/tags/跨平台/" style="font-size: 15px;">跨平台</a> <a href="/tags/effective-c/" style="font-size: 15px;">effective c++</a> <a href="/tags/传参/" style="font-size: 15px;">传参</a> <a href="/tags/性能优化/" style="font-size: 15px;">性能优化</a> <a href="/tags/读书笔记/" style="font-size: 15px;">读书笔记</a> <a href="/tags/ipv6/" style="font-size: 15px;">ipv6</a> <a href="/tags/校园网/" style="font-size: 15px;">校园网</a> <a href="/tags/百度云管家/" style="font-size: 15px;">百度云管家</a> <a href="/tags/百度网盘/" style="font-size: 15px;">百度网盘</a> <a href="/tags/APACHE/" style="font-size: 15px;">APACHE</a> <a href="/tags/config/" style="font-size: 15px;">config</a> <a href="/tags/favicon-ico/" style="font-size: 15px;">favicon.ico</a> <a href="/tags/c/" style="font-size: 15px;">c++</a> <a href="/tags/class/" style="font-size: 15px;">class</a> <a href="/tags/OOP/" style="font-size: 15px;">OOP</a> <a href="/tags/struct/" style="font-size: 15px;">struct</a> <a href="/tags/基础/" style="font-size: 15px;">基础</a> <a href="/tags/whois/" style="font-size: 15px;">whois</a> <a href="/tags/纳网/" style="font-size: 15px;">纳网</a> <a href="/tags/网络营销/" style="font-size: 15px;">网络营销</a> <a href="/tags/隐私/" style="font-size: 15px;">隐私</a> <a href="/tags/骗子/" style="font-size: 15px;">骗子</a> <a href="/tags/怀柔/" style="font-size: 15px;">怀柔</a> <a href="/tags/水长城/" style="font-size: 15px;">水长城</a> <a href="/tags/清明/" style="font-size: 15px;">清明</a> <a href="/tags/游记/" style="font-size: 15px;">游记</a> <a href="/tags/cpp/" style="font-size: 15px;">cpp</a> <a href="/tags/RVO/" style="font-size: 15px;">RVO</a> <a href="/tags/拷贝构造函数/" style="font-size: 15px;">拷贝构造函数</a> <a href="/tags/返回值优化/" style="font-size: 15px;">返回值优化</a> <a href="/tags/bug/" style="font-size: 15px;">bug</a> <a href="/tags/FPU/" style="font-size: 15px;">FPU</a> <a href="/tags/x64/" style="font-size: 15px;">x64</a> <a href="/tags/x86/" style="font-size: 15px;">x86</a> <a href="/tags/汇编/" style="font-size: 15px;">汇编</a> <a href="/tags/浮点乘法/" style="font-size: 15px;">浮点乘法</a> <a href="/tags/浮点数/" style="font-size: 15px;">浮点数</a> <a href="/tags/误差/" style="font-size: 15px;">误差</a> <a href="/tags/3次握手/" style="font-size: 15px;">3次握手</a> <a href="/tags/TCP-IP/" style="font-size: 15px;">TCP/IP</a> <a href="/tags/tcpdump/" style="font-size: 15px;">tcpdump</a> <a href="/tags/windump/" style="font-size: 15px;">windump</a> <a href="/tags/计算机网络/" style="font-size: 15px;">计算机网络</a> <a href="/tags/php图片水印/" style="font-size: 15px;">php图片水印</a> <a href="/tags/QQ空间/" style="font-size: 15px;">QQ空间</a> <a href="/tags/图片拼接/" style="font-size: 15px;">图片拼接</a> <a href="/tags/魔力日志/" style="font-size: 15px;">魔力日志</a> <a href="/tags/Android-4-2/" style="font-size: 15px;">Android 4.2</a> <a href="/tags/AutoSwitcher/" style="font-size: 15px;">AutoSwitcher</a> <a href="/tags/WRITE-SECURE-SETTINGS/" style="font-size: 15px;">WRITE_SECURE_SETTINGS</a> <a href="/tags/没有权限/" style="font-size: 15px;">没有权限</a> <a href="/tags/sqlite/" style="font-size: 15px;">sqlite</a> <a href="/tags/安全/" style="font-size: 15px;">安全</a> <a href="/tags/用户体验/" style="font-size: 15px;">用户体验</a> <a href="/tags/百度/" style="font-size: 15px;">百度</a> <a href="/tags/QT/" style="font-size: 15px;">QT</a> <a href="/tags/windows/" style="font-size: 15px;">windows</a> <a href="/tags/COM接口/" style="font-size: 15px;">COM接口</a> <a href="/tags/helloWorld/" style="font-size: 15px;">helloWorld</a> <a href="/tags/tlb文件/" style="font-size: 15px;">tlb文件</a> <a href="/tags/GPU/" style="font-size: 15px;">GPU</a> <a href="/tags/opengl/" style="font-size: 15px;">opengl</a> <a href="/tags/经验技巧/" style="font-size: 15px;">经验技巧</a> <a href="/tags/计算机图形学/" style="font-size: 15px;">计算机图形学</a> <a href="/tags/远程控制/" style="font-size: 15px;">远程控制</a> <a href="/tags/远程桌面/" style="font-size: 15px;">远程桌面</a> <a href="/tags/系统架构设计师/" style="font-size: 15px;">系统架构设计师</a> <a href="/tags/证书登记/" style="font-size: 15px;">证书登记</a> <a href="/tags/软件设计师/" style="font-size: 15px;">软件设计师</a> <a href="/tags/软考/" style="font-size: 15px;">软考</a> <a href="/tags/OS/" style="font-size: 15px;">OS</a> <a href="/tags/matlab/" style="font-size: 15px;">matlab</a></div></div><div class="widget"><div class="widget-title">最新文章</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/jquery-ajax-post-to-download-a-file/">jQuery Ajax请求下载文件资源</a></li><li class="post-list-item"><a class="post-list-link" href="/travel-to-northwest-of-China/">毕业旅行之大西北游</a></li><li class="post-list-item"><a class="post-list-link" href="/codecolorer-adapted-to-highlight/">将代码高亮插件codecolorer替换为highlight</a></li><li class="post-list-item"><a class="post-list-link" href="/binding-domain-to-plugin-of-mobile-theme/">给手机主题插件Wptouch绑定单独的域名</a></li><li class="post-list-item"><a class="post-list-link" href="/share-beamer-with-tsinghua-theme/">分享一个清华主题的beamer模版</a></li><li class="post-list-item"><a class="post-list-link" href="/install-vim-latex-suite-in-mac-osx//">Mac下安装使用vim插件latex-suite</a></li><li class="post-list-item"><a class="post-list-link" href="/travel-to-vietnam//">越南10日游记</a></li><li class="post-list-item"><a class="post-list-link" href="/summary-of-year-2014//">2014年终总结</a></li><li class="post-list-item"><a class="post-list-link" href="/android-airplanemode-auto-switcher-v2//">飞行模式助手</a></li><li class="post-list-item"><a class="post-list-link" href="/leetcode-summary//">leetcode总结</a></li></ul></div><div class="widget"><div class="widget-title">友情链接</div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><div id="footer">© <a href="/." rel="nofollow">tanglei's blog|唐磊的个人博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/totop.js" type="text/javascript"></script><script src="/js/fancybox.pack.js" type="text/javascript"></script>
<script src="/js/jquery.fancybox.js" type="text/javascript"></script><link rel="stylesheet" href="/css/jquery.fancybox.css" type="text/css"></div></body></html>